.. _Security:

Security
=========

Authentication
--------------
.. _WAYF:

WAYF (Where Are You From)
``````````````````````````
WAYF is a Single Sign-On system which permits using one single login to access several Web based services (`<http://www.wayf.dk/>`_). It creates connection between our application and many provided institutions. 

Only persons who are associated with an institution that uses WAYF can log on our application. 

The user can only be authenticated to access our application when their institutional credentials - username and password are verified by the institutions. 

The following diagram illustrates that how WAYF interacts between our application and the connected institutions.

.. figure::  images/WAYF.png

   :align:   center


.. _JWT:

JWT (JSON Web Tokens)
``````````````````````
JSON Web Tokens are an open, industry standard (`RFC 7519 <https://tools.ietf.org/html/rfc7519>`_) method for representing claims securely between two parties (`<https://jwt.io/>`_).

In our application, when the user successfully logs in using their credentials, a JWT will be returned and saved. Whenever the user wants to access a service, the JWT will be sent to the service in the authorization header using the Bearer schema. The service checks for a valid JWT in the authorization header, and if it's present, the user will be allowed to access the service.

(Here comes a diagram)

Authorization
-------------
Roles and Permissions
``````````````````````
  
* Leader -
* Team member -
* Admin -
* Data facilitator -
* App Designer -


File Sensitivity Level
```````````````````````

* Open access -  
* Confidential - 
* Sensitive -


Auditing and Logging
---------------------
iRODS-Re-Audit Plugin
``````````````````````
We have improved the `official iRODS audit plugin <https://irods.org/2016/12/auditing-irods-with-the-audit-plugin-and-elastic-stack/>`_. The official iRODS audit plugin generates messages whenever a dynamic policy enforcement point (PEP) is fired, and ours filters the messages from the messages which is generated by the official iRODS audit plugin. The outputs is an rotating log file which locates at ``/var/lib/irods/log/audit.log``.

The following table lists the users' actions that can be logged by our iRODS audit plugin.

+-------------------+--------------------+--------------------------------------------------------------------------+
|iCommands          |Message type        |Description                                                               |
+===================+====================+==========================================================================+
|iput               |putObject           |Store a file into iRODS.                                                  |
+-------------------+--------------------+--------------------------------------------------------------------------+
|iget               |objectAccessed      |Get data-objects or collections from iRODS space, either to the specified |
|                   |                    |local area or to the current working directory.                           |
+-------------------+--------------------+--------------------------------------------------------------------------+
|iadmin mkuser      |userCreation        |Create a new iRODS user in the ICAT database.                             |
+-------------------+--------------------+--------------------------------------------------------------------------+
|igroupadmin mkgroup|userCreation        |Create a user group.                                                      |
+-------------------+--------------------+--------------------------------------------------------------------------+
|icp                |objectAccess        |Copies an irods data-object (file) or collection (directory) to another   |
|                   |dataObjCopy         |data-object or collection.                                                |
+-------------------+--------------------+--------------------------------------------------------------------------+
|irm                |dataObjRemove       |Remove one or more data-object or collection from iRODS space.            |
+-------------------+--------------------+--------------------------------------------------------------------------+
|imv                |dataObjRename       |Moves/renames an irods data-object (file) or collection (directory) to    |
|                   |                    |another, data-object or collection.                                       |
+-------------------+--------------------+--------------------------------------------------------------------------+
|ichmod             |objectModeModified  |Modify access to dataObjects (iRODS files) and collections (directories). |
+-------------------+--------------------+--------------------------------------------------------------------------+
|iadmin mkresc      |createResource      |Create (register) a new coordinating or storage resource.                 |
+-------------------+--------------------+--------------------------------------------------------------------------+
|imeta add          |metadataModification|Modify iRODS metadata.                                                    |
+-------------------+--------------------+--------------------------------------------------------------------------+
|imeta rm           |metadataModification|Delete iRODS metadata.                                                    |
+-------------------+--------------------+--------------------------------------------------------------------------+

.. note::
   For more information on our iRODS audit plugin please refer to `<https://github.com/SDU-eScience/irods-re-audit>`_
   

Kafka
``````
Our application consists of microservices, which use Kafka Streams API - a Java library to transform events into real-time data pipeline. 

(Here needs to be discussed what is exactly the advantages of using Kafka from security perspective)
 

Prometheus Plugin and Grafana
``````````````````````````````
The Ceph Prometheus plugin provides a Prometheus exporter to pass on Ceph performance counters from the collection point in Ceph-mgr. The exported data can be queried from Grafanawhich allows us to query, visualize, alert on the Ceph metrics.

.. figure::  images/grafana.png
   :align:   center


Confidentiality
----------------
ACLs (Access Control Lists)
```````````````````````````
* Owner - The owner of a data object has full control of the file.
* Read -
* Write -


Encryption
``````````

Integrity
---------

Availability
-------------
